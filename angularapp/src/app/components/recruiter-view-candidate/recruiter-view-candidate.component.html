<app-recruiter-navbar></app-recruiter-navbar>

<div class="container mt-2">
  <h3 class="text-center mb-4">Candidates</h3>

  <input type="text" class="form-control mb-2" placeholder="Search by name, email or phone" [(ngModel)]="searchText" (input)="applyFilter()"/>

  <div class="table-responsive">
    <table class="table table-bordered table-striped">
      <thead class="thead-dark text-center">
        <tr>
          <th>S.No</th>
          <th>Name</th>
          <th>Email</th>
          <th>Phone</th>
          <th>Educational Qualification</th>
          <th>Experience</th>
          <th>Tech Stack</th>
          <th>Resume URL</th>
          <th>Application Date</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody *ngIf="paginatedCandidates.length; else noRecords">
        <tr *ngFor="let candidate of paginatedCandidates; let i = index" class="text-center">
          <td>{{ (currentPage - 1) * pageSize + i + 1 }}</td>
          <td>{{ candidate.name }}</td>
          <td>{{ candidate.email }}</td>
          <td>{{ candidate.phone }}</td>
          <td>{{ candidate.educationalQualification }}</td>
          <td>{{ candidate.experience }}</td>
          <td>{{ candidate.techStack }}</td>
          <td><a [href]="candidate.resumeUrl" target="_blank">View Resume</a></td>
          <td>{{ candidate.applicationDate | date:'MMM dd, yyyy' }}</td>
          <td>{{ candidate.status }}</td>
          <td>
            <button class="btn btn-success btn-sm me-1 mb-2" (click)="onEdit(candidate._id)">Edit</button>
            <button class="btn btn-danger btn-sm" (click)="confirmDelete(candidate._id)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <ng-template #noRecords>
    <tr>
      <td colspan="11" class="text-center">Oops! No records found</td>
    </tr>
  </ng-template>

  <!-- Pagination -->
  <nav *ngIf="filteredCandidates.length > pageSize" class="mt-3">
    <ul class="pagination justify-content-center">
      <li class="page-item" [class.disabled]="currentPage === 1">
        <a class="page-link" (click)="previousPage()">Previous</a>
      </li>
  
      <li class="page-item" *ngFor="let page of pages" [class.active]="currentPage === page">
        <a class="page-link" (click)="changePage(page)">{{ page }}</a>
      </li>
  
      <li class="page-item" [class.disabled]="currentPage === totalPages">
        <a class="page-link" (click)="nextPage()">Next</a>
      </li>
    </ul>
  </nav>

<!-- Delete Modal -->
<div *ngIf="isDeleteModal" class="custom-modal-overlay">
    <div class="custom-modal">
      <h5 class="text-danger">Delete Candidate</h5>
      <p>Are you sure you want to delete this candidate?</p>
      <div class="d-flex justify-content-end mt-3">
        <button class="btn btn-danger me-2" (click)="deleteCandidate()">Yes</button>
        <button class="btn btn-secondary" (click)="cancelDelete()">Cancel</button>
      </div>
    </div>
  </div>
  
