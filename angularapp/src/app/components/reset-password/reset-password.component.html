<app-navbar></app-navbar>

<div class="container d-flex justify-content-center align-items-center py-5 min-vh-100">
    <div class="card shadow p-4 rounded-4" style="width: 90%; max-width: 900px;">

        <div class="row g-0">
            <!-- Left Side - Illustration (50%) -->
            <div class="col-md-6 d-flex align-items-center justify-content-center p-4">
                <div class="illustration-container">
                    <img src="https://img.freepik.com/free-vector/computer-login-concept-illustration_114360-7962.jpg"
                         alt="Reset password illustration" 
                         class="img-fluid"
                         style="max-height: 350px;">
                </div>
            </div>

            <!-- Right Side - Form (50%) -->
            <div class="col-md-6 d-flex align-items-center">
                <div class="card-body text-center p-4">
                    <div class="form-container">
                        <h2 class="mb-4">Reset Password</h2>
                        <p class="text-muted mb-4">Create a new password for your account</p>

                        <form [formGroup]="resetForm" (ngSubmit)="onSubmit()">
                            <div class="form-group mb-3 text-start">
                                <label for="email" class="form-label">Email Address</label>
                                <input
                                    type="email"
                                    id="email"
                                    formControlName="email"
                                    class="form-control form-control-lg" readonly
                                    [ngClass]="{ 'is-invalid': f.email.invalid && (f.email.dirty || f.email.touched || isSubmitted) }"
                                    placeholder="Enter your email"
                                >
                                <div *ngIf="f.email.errors && (f.email.dirty || f.email.touched || isSubmitted)" class="invalid-feedback text-start">
                                    <div *ngIf="f.email.errors['required']">Email is required</div>
                                    <div *ngIf="f.email.errors['email']">Please enter a valid email</div>
                                </div>
                            </div>

                            <div class="form-group mb-3 text-start">
                                <label for="password" class="form-label">New Password</label>
                                <input
                                    type="password"
                                    id="password"
                                    formControlName="password"
                                    class="form-control form-control-lg"
                                    [ngClass]="{ 'is-invalid': f.password.invalid && (f.password.dirty || f.password.touched || isSubmitted) }"
                                    placeholder="Enter new password"
                                >
                                <div *ngIf="f.password.errors && (f.password.dirty || f.password.touched || isSubmitted)" class="invalid-feedback text-start">
                                    <div *ngIf="f.password.errors['required']">Password is required</div>
                                    <div *ngIf="f.password.errors['minlength']">Password must be at least 8 characters</div>
                                    <div *ngIf="f.password.errors['pattern']">Password must contain atleast 1 Uppercase, 1 Lowercase, 1 special character and Numeric value.</div>
                                </div>
                                <span class=" mt-1">
                                    <span class="text-danger">* </span>Note :- <li>Password must contain atleast 1 Uppercase, 1
                                        Lowercase, 1 special character and Numeric value.</li>
                                    <li>Password must have atleast 8 characters.</li>
                                </span>
                            </div>

                            <div class="form-group mb-3 text-start">
                                <label for="confirmPassword" class="form-label">Confirm Password</label>
                                <input
                                    type="password"
                                    id="confirmPassword"
                                    formControlName="confirmPassword"
                                    class="form-control form-control-lg"
                                    [ngClass]="{ 'is-invalid': (f.confirmPassword.invalid || resetForm.errors?.mismatch) && (f.confirmPassword.dirty || f.confirmPassword.touched || isSubmitted) }"
                                    placeholder="Confirm new password"
                                >
                                <div *ngIf="f.confirmPassword.errors && (f.confirmPassword.dirty || f.confirmPassword.touched || isSubmitted)" class="invalid-feedback text-start">
                                    <div *ngIf="f.confirmPassword.errors['required']">Please confirm your password</div>
                                </div>
                                <div *ngIf="resetForm.errors?.mismatch && (f.confirmPassword.dirty || f.confirmPassword.touched || isSubmitted)" class="invalid-feedback text-start">
                                    Passwords do not match
                                </div>
                            </div>

                            <div class="form-group mb-3">
                                <button type="submit" class="btn btn-primary btn-lg w-100 py-2" [disabled]="resetForm.invalid || isSubmitted">
                                    <span *ngIf="!isSubmitted">Reset Password</span>
                                    <span *ngIf="isSubmitted">
                                        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                        Processing...
                                    </span>
                                </button>
                            </div>
                        </form>

                        <div class="text-center mt-3">
                            <a routerLink="/login" class="text-decoration-none">Back to Login</a>
                        </div>

                        <!-- Feedback Messages -->
                        <div *ngIf="message" class="alert alert-success mt-3">
                            <i class="bi bi-check-circle me-2"></i> {{ message }}
                        </div>
                        <div *ngIf="error" class="alert alert-danger mt-3">
                            <i class="bi bi-exclamation-triangle me-2"></i> {{ error }}
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>